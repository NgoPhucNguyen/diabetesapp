theme_minimal()
dbWriteTable(con, "enrollments", enrollments, overwrite = TRUE)
# Course: DSR301m-FA25 Lab / Name: NgÃ´ PhÃºc NguyÃªn / ID: SE192616 / Class: AI1914
#============1==========
repeat {
cat("\n===== Rock - Paper - Scissors Game =====\n")
cat("Your options: rock / paper / scissors\n")
player1 <- tolower(readline("Player 1: "))
player2 <- tolower(readline("Player 2: "))
valid_choices <- c("rock", "paper", "scissors")
if (!(player1 %in% valid_choices) || !(player2 %in% valid_choices)) {
cat("Please enter only: rock, paper, or scissors!\n")
} else if (player1 == player2) {
cat("It's a draw!\n")
} else if (
(player1 == "scissors" && player2 == "paper") ||
(player1 == "paper" && player2 == "rock") ||
(player1 == "rock" && player2 == "scissors")
) {
cat("Player 1 wins!\n")
} else {
cat("Player 2 wins!\n")
}
# Ask if players want to continue
cont <- toupper(readline("Do you want to play again? (Y/N): "))
if (cont != "Y") {
cat("\nThank you for playing! See you next time!\n")
break
}
}
is_prime <- function(n) {
if (n == 2) {
return(TRUE)
}
if (n <= 1) {
return(FALSE)
}
for (i in 2:(n-1)) {
if (n %% i == 0) {
return(FALSE)
}
}
return(TRUE)
}
repeat {
cat("\n===== Prime Number Checker =====\n")
# User enters a vector
nums <- as.numeric(strsplit(readline("Enter a vector of numbers (separated by spaces): "), " ")[[1]])
# Check each number
for (num in nums) {
if (is_prime(num)) {
cat(num, "is a prime number.\n")
} else {
cat(num, "is NOT a prime number.\n")
}
}
# Ask to continue
cont <- toupper(readline("Do you want to continue? (Y/N): "))
if (cont != "Y") {
cat("\nThank you for using the Prime Checker. Goodbye!\n")
break
}
}
#==============3===========
check_data_quality <- function(df, column_name) {
# Check if column exists
if (!(column_name %in% colnames(df))) {
cat("âŒ Column", column_name, "does not exist in the data frame.\n")
return(invisible(NULL))
}
# Extract the column
column_data <- df[[column_name]]
cat("ðŸ” Checking column:", column_name, "\n")
# Numeric column checks
if (is.numeric(column_data)) {
na_count <- sum(is.na(column_data))
negative_count <- sum(column_data < 0, na.rm = TRUE)
cat("â€¢ Missing values (NA):", na_count, "\n")
cat("â€¢ Negative values:", negative_count, "\n")
}
# Character column checks
if (is.character(column_data)) {
empty_strings <- sum(column_data == "", na.rm = TRUE)
cat("â€¢ Empty strings:", empty_strings, "\n")
}
}
# ===== Example data =====
test_df <- data.frame(
age = c(25, -1, 30, NA, 40),
salary = c(50000, 60000, 45000, 70000, 0),
name = c("An", "", "Tuan", "Bao", "Hung"),
stringsAsFactors = FALSE
)
# ===== Run function =====
check_data_quality(test_df, "age")
check_data_quality(test_df, "salary")
check_data_quality(test_df, "name")
check_data_quality(test_df, "height")  # Test missing column
#==============3===========
#==============4===========
# Load required libraries
library(DBI)
library(RSQLite)
# Connect to SQLite database (it will create it if not existing)
con <- dbConnect(RSQLite::SQLite(), "mydatabase.db")
# Drop existing tables (for rerun safety)
dbExecute(con, "DROP TABLE IF EXISTS enrollments;")
dbExecute(con, "DROP TABLE IF EXISTS students;")
dbExecute(con, "DROP TABLE IF EXISTS courses;")
# Create tables
dbExecute(con, "
CREATE TABLE students (
student_id INTEGER PRIMARY KEY,
name TEXT,
age INTEGER,
email TEXT
);
")
dbExecute(con, "
CREATE TABLE courses (
course_id INTEGER PRIMARY KEY,
course_name TEXT,
credits INTEGER
);
")
dbExecute(con, "
CREATE TABLE enrollments (
enroll_id INTEGER PRIMARY KEY,
student_id INTEGER,
course_id INTEGER,
grade REAL,
FOREIGN KEY (student_id) REFERENCES students(student_id),
FOREIGN KEY (course_id) REFERENCES courses(course_id)
);
")
# Insert data into students (at least one NULL)
dbExecute(con, "
INSERT INTO students (student_id, name, age, email) VALUES
(1, 'Alice', 21, 'alice@mail.com'),
(2, 'Bob', NULL, 'bob@mail.com'),
(3, 'Charlie', 23, NULL),
(4, 'Diana', 22, 'diana@mail.com'),
(5, 'Evan', 24, 'evan@mail.com'),
(6, 'Fiona', 20, 'fiona@mail.com');
")
# Insert data into courses (with one NULL)
dbExecute(con, "
INSERT INTO courses (course_id, course_name, credits) VALUES
(1, 'Mathematics', 3),
(2, 'Physics', 4),
(3, 'Computer Science', NULL),
(4, 'Statistics', 3),
(5, 'Data Science', 5);
")
# Insert data into enrollments (with NULL grade)
dbExecute(con, "
INSERT INTO enrollments (enroll_id, student_id, course_id, grade) VALUES
(1, 1, 1, 90),
(2, 1, 2, 85),
(3, 2, 1, NULL),
(4, 2, 3, 88),
(5, 3, 4, 92),
(6, 3, 5, 75),
(7, 4, 2, 80),
(8, 4, 5, 95),
(9, 5, 1, 70),
(10, 5, 4, 85),
(11, 6, 3, 89);
")
# Verify tables
dbListTables(con)
dbReadTable(con, "students")
dbReadTable(con, "courses")
dbReadTable(con, "enrollments")
#==============4===========
#==============5===========
library(DBI)
library(dplyr)
# Read data from database
students <- dbReadTable(con, "students")
courses <- dbReadTable(con, "courses")
enrollments <- dbReadTable(con, "enrollments")
# --- Data Preview ---
cat("===== Data Preview =====\n")
print(head(students))
print(head(courses))
print(head(enrollments))
# --- Summary Statistics ---
cat("\n===== Summary Statistics =====\n")
print(summary(students))
print(summary(courses))
print(summary(enrollments))
# --- Missing Data Check ---
cat("\n===== Missing Data Check =====\n")
cat("Students NA count:\n"); print(colSums(is.na(students)))
cat("Courses NA count:\n"); print(colSums(is.na(courses)))
cat("Enrollments NA count:\n"); print(colSums(is.na(enrollments)))
# --- Handle Missing Data ---
# Replace missing ages with mean age
students$age[is.na(students$age)] <- mean(students$age, na.rm = TRUE)
# Replace missing course names with "Unknown"
courses$course_name[is.na(courses$course_name)] <- "Unknown"
# Replace missing grades by course average
enrollments <- enrollments %>%
group_by(course_id) %>%
mutate(grade = ifelse(is.na(grade), mean(grade, na.rm = TRUE), grade)) %>%
ungroup()
# --- Update cleaned data back into database ---
dbWriteTable(con, "students", students, overwrite = TRUE)
dbWriteTable(con, "courses", courses, overwrite = TRUE)
dbWriteTable(con, "enrollments", enrollments, overwrite = TRUE)
cat("\nâœ… Missing data handled and database updated successfully.\n")
#==============5===========
#==============6===========
library(ggplot2)
# Join tables
joined <- dbGetQuery(con, "
SELECT s.name, s.age, c.course_name, e.grade
FROM enrollments e
JOIN students s ON e.student_id = s.student_id
JOIN courses c ON e.course_id = c.course_id
")
# --- 1 Average Grade per Student ---
avg_student <- joined %>%
group_by(name) %>%
summarise(avg_grade = mean(grade))
ggplot(avg_student, aes(x = name, y = avg_grade, fill = name)) +
geom_col() +
labs(title = "Average Grade per Student", x = "Student", y = "Average Grade") +
theme_minimal()
# --- 2 Average Grade per Course ---
avg_course <- joined %>%
group_by(course_name) %>%
summarise(avg_grade = mean(grade))
ggplot(avg_course, aes(x = course_name, y = avg_grade, fill = course_name)) +
geom_col() +
labs(title = "Average Grade per Course", x = "Course", y = "Average Grade") +
theme_minimal()
# --- 3 Grade Distribution ---
ggplot(joined, aes(x = grade, fill = course_name)) +
geom_histogram(bins = 10, alpha = 0.7, position = "identity") +
labs(title = "Grade Distribution", x = "Grade", y = "Count") +
theme_minimal()
# --- 4 Boxplot of Grades per Course ---
ggplot(joined, aes(x = course_name, y = grade, fill = course_name)) +
geom_boxplot() +
labs(title = "Grade Spread by Course", x = "Course", y = "Grade") +
theme_minimal()
#==============6===========
source("D:/1practiceR.R")
cat("Working directory:", getwd(), "\n")
cat("Working directory:", getwd(), "\n")
# =====================================================
# Rscript.R
# Generate multiple diabetes dataset plots
# Output: images saved in backend/data/plots/
# =====================================================
setwd("D:/DSR301_web/backend/data")
cat("Working directory:", getwd(), "\n")
cat("Files in current directory:\n")
print(list.files())
cat("Reading CSV file...\n")
data_path <- "diabetes_012_health_indicators_BRFSS2015.csv"
if (!file.exists(data_path)) {
stop("File not found: ", data_path)
}
getwd()
# =====================================================
# Rscript.R
# Generate multiple diabetes dataset plots
# Output: images saved in backend/data/plots/
# =====================================================
setwd("D:/DSR301_web/backend")
cat("Working directory:", getwd(), "\n")
cat("Files in current directory:\n")
print(list.files())
cat("Reading CSV file...\n")
data_path <- "backend\diabetes_012_health_indicators_BRFSS2015.csv"
# =====================================================
# Rscript.R
# Generate multiple diabetes dataset plots
# Output: images saved in backend/plots/
# =====================================================
# --- Setup working directory ---
setwd("D:/DSR301_web/backend")
cat("Working directory:", getwd(), "\n")
cat("Files in current directory:\n")
print(list.files())
# --- Read dataset ---
cat("Reading CSV file...\n")
data_path <- "diabetes_012_health_indicators_BRFSS2015.csv"
if (!file.exists(data_path)) {
stop("âŒ File not found: ", data_path)
}
df <- read.csv(data_path)
cat("âœ… Loaded data with", nrow(df), "rows and", ncol(df), "columns\n")
# --- Prepare output folder ---
output_dir <- "plots"
if (!dir.exists(output_dir)) dir.create(output_dir)
cat("Saving plots to:", output_dir, "\n")
cat("Rscript setup finished âœ…\n")
# --- Load libraries ---
library(ggplot2)
library(reshape2)
library(corrplot)
library(dplyr)
library(readr)
# --- Manifest file path ---
manifest_path <- file.path(output_dir, "manifest.csv")
# --- Load dataset properly with readr (better performance) ---
cat("Reloading dataset with readr...\n")
data <- read_csv(data_path, show_col_types = FALSE)
cat("Loaded rows:", nrow(data), "\n")
# --- Clean column names ---
names(data) <- make.names(names(data))
# --- Helper function to save ggplots ---
save_plot <- function(plot, filename, width = 7, height = 5) {
filepath <- file.path(output_dir, filename)
ggsave(filepath, plot = plot, width = width, height = height, dpi = 150)
return(filepath)
}
# --- Initialize manifest data frame ---
manifest <- data.frame(
file = character(),
title = character(),
description = character(),
stringsAsFactors = FALSE
)
# =====================================================
# 1. Histogram of BMI
# =====================================================
if ("BMI" %in% names(data)) {
p <- ggplot(data, aes(x = BMI)) +
geom_histogram(fill = "skyblue", bins = 30) +
theme_minimal() +
ggtitle("Distribution of BMI")
save_plot(p, "hist_bmi.png")
manifest <- rbind(manifest, c("hist_bmi.png", "BMI Distribution", "Shows the overall BMI distribution in dataset"))
}
# =====================================================
# 2. Bar plot of Diabetes prevalence by Sex
# =====================================================
if (all(c("Diabetes_012", "Sex") %in% names(data))) {
bar_data <- data %>%
group_by(Sex, Diabetes_012) %>%
summarise(count = n(), .groups = "drop")
p <- ggplot(bar_data, aes(x = Sex, y = count, fill = factor(Diabetes_012))) +
geom_bar(stat = "identity", position = "dodge") +
theme_minimal() +
ggtitle("Diabetes prevalence by Sex") +
labs(fill = "Diabetes_012")
save_plot(p, "bar_diabetes_by_sex.png")
manifest <- rbind(manifest, c("bar_diabetes_by_sex.png", "Diabetes by Sex", "Shows how diabetes cases vary between sexes"))
}
# =====================================================
# 3. Boxplot of BMI by Diabetes category
# =====================================================
if (all(c("BMI", "Diabetes_012") %in% names(data))) {
p <- ggplot(data, aes(x = factor(Diabetes_012), y = BMI, fill = factor(Diabetes_012))) +
geom_boxplot() +
theme_minimal() +
ggtitle("BMI by Diabetes Category") +
labs(x = "Diabetes (0=No, 1=Pre, 2=Yes)", y = "BMI")
save_plot(p, "box_bmi_by_diabetes.png")
manifest <- rbind(manifest, c("box_bmi_by_diabetes.png", "BMI vs Diabetes", "Compare BMI across diabetes categories"))
}
# =====================================================
# 4. Scatter plot of HighChol vs BMI
# =====================================================
if (all(c("BMI", "HighChol", "Diabetes_012") %in% names(data))) {
p <- ggplot(data, aes(x = BMI, y = HighChol, color = factor(Diabetes_012))) +
geom_jitter(alpha = 0.4) +
theme_minimal() +
ggtitle("BMI vs HighChol by Diabetes") +
labs(x = "BMI", y = "HighChol", color = "Diabetes")
save_plot(p, "scatter_bmi_highchol.png")
manifest <- rbind(manifest, c("scatter_bmi_highchol.png", "Scatter BMI vs HighChol", "Relationship between BMI and cholesterol"))
}
# =====================================================
# 5. Correlation heatmap
# =====================================================
num_data <- data %>% select(where(is.numeric))
if (ncol(num_data) > 1) {
cor_mat <- cor(num_data, use = "pairwise.complete.obs")
png(file.path(output_dir, "corr_heatmap.png"), width = 900, height = 700)
corrplot(cor_mat, method = "color", tl.cex = 0.6)
dev.off()
manifest <- rbind(manifest, c("corr_heatmap.png", "Correlation Heatmap", "Correlations among numeric features"))
}
# =====================================================
# Save manifest file
# =====================================================
write_csv(manifest, manifest_path)
cat("âœ… Done! Plots saved to:", output_dir, "\n")
cat("Manifest file:", manifest_path, "\n")
# =====================================================
# Rscript.R
# Generate multiple diabetes dataset plots
# Output: images saved in backend/data/plots/
# =====================================================
# --- Setup working directory ---
setwd("D:/DSR301_web/backend")
cat("Working directory:", getwd(), "\n")
cat("Files in current directory:\n")
print(list.files())
# --- Read dataset ---
cat("Reading CSV file...\n")
data_path <- "diabetes_012_health_indicators_BRFSS2015.csv"
if (!file.exists(data_path)) {
stop("âŒ File not found: ", data_path)
}
df <- read.csv(data_path)
cat("âœ… Loaded data with", nrow(df), "rows and", ncol(df), "columns\n")
# --- Prepare output folder ---
output_dir <- "data/plots"
if (!dir.exists(output_dir)) dir.create(output_dir, recursive = TRUE)
cat("Saving plots to:", output_dir, "\n")
cat("Rscript setup finished âœ…\n")
# --- Load libraries ---
library(ggplot2)
library(reshape2)
library(corrplot)
library(dplyr)
library(readr)
# --- Manifest file path ---
manifest_path <- file.path(output_dir, "manifest.csv")
# --- Load dataset ---
cat("Loading dataset...\n")
data <- read_csv(data_path, show_col_types = FALSE)
cat("Loaded rows:", nrow(data), "\n")
# --- Clean column names ---
names(data) <- make.names(names(data))
# --- Helper function to save ggplots ---
save_plot <- function(plot, filename, width = 7, height = 5) {
filepath <- file.path(output_dir, filename)
ggsave(filepath, plot = plot, width = width, height = height, dpi = 150)
return(filepath)
}
# --- Initialize manifest data frame ---
manifest <- data.frame(
file = character(),
title = character(),
description = character(),
stringsAsFactors = FALSE
)
# =====================================================
# 1. Histogram of BMI
# =====================================================
if ("BMI" %in% names(data)) {
p <- ggplot(data, aes(x = BMI)) +
geom_histogram(fill = "skyblue", bins = 30) +
theme_minimal() +
ggtitle("Distribution of BMI")
save_plot(p, "hist_bmi.png")
manifest <- rbind(manifest, c("hist_bmi.png", "BMI Distribution", "Shows the overall BMI distribution in dataset"))
}
# =====================================================
# 2. Bar plot of Diabetes prevalence by Sex
# =====================================================
if (all(c("Diabetes_012", "Sex") %in% names(data))) {
bar_data <- data %>%
group_by(Sex, Diabetes_012) %>%
summarise(count = n(), .groups = "drop")
p <- ggplot(bar_data, aes(x = Sex, y = count, fill = factor(Diabetes_012))) +
geom_bar(stat = "identity", position = "dodge") +
theme_minimal() +
ggtitle("Diabetes prevalence by Sex") +
labs(fill = "Diabetes_012")
save_plot(p, "bar_diabetes_by_sex.png")
manifest <- rbind(manifest, c("bar_diabetes_by_sex.png", "Diabetes by Sex", "Shows how diabetes cases vary between sexes"))
}
# =====================================================
# 3. Boxplot of BMI by Diabetes category
# =====================================================
if (all(c("BMI", "Diabetes_012") %in% names(data))) {
p <- ggplot(data, aes(x = factor(Diabetes_012), y = BMI, fill = factor(Diabetes_012))) +
geom_boxplot() +
theme_minimal() +
ggtitle("BMI by Diabetes Category") +
labs(x = "Diabetes (0=No, 1=Pre, 2=Yes)", y = "BMI")
save_plot(p, "box_bmi_by_diabetes.png")
manifest <- rbind(manifest, c("box_bmi_by_diabetes.png", "BMI vs Diabetes", "Compare BMI across diabetes categories"))
}
# =====================================================
# 4. Scatter plot of HighChol vs BMI
# =====================================================
if (all(c("BMI", "HighChol", "Diabetes_012") %in% names(data))) {
p <- ggplot(data, aes(x = BMI, y = HighChol, color = factor(Diabetes_012))) +
geom_jitter(alpha = 0.4) +
theme_minimal() +
ggtitle("BMI vs HighChol by Diabetes") +
labs(x = "BMI", y = "HighChol", color = "Diabetes")
save_plot(p, "scatter_bmi_highchol.png")
manifest <- rbind(manifest, c("scatter_bmi_highchol.png", "Scatter BMI vs HighChol", "Relationship between BMI and cholesterol"))
}
# =====================================================
# 5. Correlation heatmap
# =====================================================
num_data <- data %>% select(where(is.numeric))
if (ncol(num_data) > 1) {
cor_mat <- cor(num_data, use = "pairwise.complete.obs")
png(file.path(output_dir, "corr_heatmap.png"), width = 900, height = 700)
corrplot(cor_mat, method = "color", tl.cex = 0.6)
dev.off()
manifest <- rbind(manifest, c("corr_heatmap.png", "Correlation Heatmap", "Correlations among numeric features"))
}
# =====================================================
# Save manifest file
# =====================================================
write_csv(manifest, manifest_path)
cat("âœ… Done! Plots saved to:", output_dir, "\n")
cat("Manifest file:", manifest_path, "\n")
